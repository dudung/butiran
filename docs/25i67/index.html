<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>reg npprel-protocol | butiran</title>
<link rel=stylesheet href=/butiran/css/main.min.5d949e138e137f26bbbc6fbe151c3e39ca49a674bd5c6f0f3a9ff79176ee1043.css integrity="sha256-XZSeE44Tfya7vG++FRw+OcpJpnS9XG8POp/3kXbuEEM=" crossorigin=anonymous><script src=/butiran/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css></head><body><header><link rel=stylesheet href='/butiran/css/header.css?v=1761916141'><h1>butiran</h1><nav><ul><li><a href=/butiran/>Home</a></li></ul></nav></header><main><head><link rel=stylesheet href='/butiran/css/notes.css?v=1761916141'></head><div class=note-container><h1 class=note-title>reg npprel-protocol</h1><div class=info-after-title><ul class=authors-container><li class=author><a href=https://dudung.github.io/butiran/authors/viridi/>Sparisoma Viridi</a></li></ul><div class=date-reading-time-edit><time datetime="2025-09-21T15:32:56 07:00">21 Sep 2025</time>
&#183;
3 mins read</div></div><div class=note-content><p>Previous approach to launch a Hugo post via link in a HTML page hosted locally is still inconvenient due to absolute path to the file <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. Here better approach is reported as sugggested in a discussion with GPT-5 <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. Steps to create own URL Protocol in Windows seems obvious <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, but not for me until today.</p><h2 id=demo>demo</h2><p>As example <a href=npprel:///25/i/67-reg-npprel-protocol.md>edit</a>
this post. Click no the link <code>edit</code> will open Notepad++ editing the post.</p><h2 id=shortcode>shortcode</h2><p>Content of <code>link/npprel.html</code> in <code>layouts/shortcodes/</code> is as follow</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;npprel:///{{ .Get 0 }}&#34;</span>&gt;{{ if .Get 1 }}{{ .Get 1 }}{{ else }}edit{{ end }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>{{&lt; <span style=color:#a6e22e>link</span><span style=color:#f92672>/</span><span style=color:#a6e22e>npprel</span> <span style=color:#e6db74>&#34;25/i/67-reg-npprel-protocol.md&#34;</span> <span style=color:#e6db74>&#34;edit&#34;</span> &gt;}}
</span></span></code></pre></div><p>is how to use it.</p><h2 id=handler>handler</h2><p>Content of <code>npprel.py</code> in <code>setup/npprel/</code> is as follow</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> os<span style=color:#f92672>,</span> sys<span style=color:#f92672>,</span> subprocess<span style=color:#f92672>,</span> urllib.parse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- Notepad++ path per machine ---</span>
</span></span><span style=display:flex><span>NOTEPADPP <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;C:\Program Files\Notepad++\notepad++.exe&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This script is in &lt;repo&gt;\setup\npprel\npprel.py</span>
</span></span><span style=display:flex><span>script_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(__file__))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># repo root is two levels up</span>
</span></span><span style=display:flex><span>repo_root <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(script_dir, os<span style=color:#f92672>.</span>pardir, os<span style=color:#f92672>.</span>pardir))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#e6db74>&#34;Usage: npprel.py &lt;url&gt;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>]  <span style=color:#75715e># e.g. npprel://content/post/my-post.md</span>
</span></span><span style=display:flex><span>parsed <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>parse<span style=color:#f92672>.</span>urlparse(url)
</span></span><span style=display:flex><span>rel_path <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>parse<span style=color:#f92672>.</span>unquote(parsed<span style=color:#f92672>.</span>path)<span style=color:#f92672>.</span>lstrip(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>folder_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;content/posts/&#34;</span>
</span></span><span style=display:flex><span>full_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>normpath(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(repo_root, folder_path, rel_path))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(full_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(full_path):
</span></span><span style=display:flex><span>    subprocess<span style=color:#f92672>.</span>run([NOTEPADPP])  <span style=color:#75715e># just open N++ if missing</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    subprocess<span style=color:#f92672>.</span>run([NOTEPADPP, full_path])
</span></span></code></pre></div><p>and it will be called when <code>npprel://</code> url protocol is clicked in a HTML file.</p><h2 id=installer>installer</h2><p>Content of <code>install-npprel.bat</code> in <code>setup/</code> is as follow</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch><span style=display:flex><span>@<span style=color:#66d9ef>echo</span> off
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> Installing npprel:// protocol handler...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>REM Use Python in the standard user path</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> PYTHON_PATH=%LOCALAPPDATA%\Programs\Python\Python312\python.exe
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> SCRIPT_PATH=%~dp0npprel.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>REM Build a temporary reg file with correct paths</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> TMPREG=%TEMP%\npprel.reg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>REM Escape backslashes for .reg</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#e6db74>&#34;PYTHON_PATH_ESC=</span>%PYTHON_PATH:\=\\%<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#e6db74>&#34;SCRIPT_PATH_ESC=</span>%SCRIPT_PATH:\=\\%<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> Windows Registry Editor Version 5.00
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span>.
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> [HKEY_CURRENT_USER\Software\Classes\npprel]
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> @=<span style=color:#e6db74>&#34;URL:npprel Protocol&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;URL Protocol&#34;</span>=<span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span>.
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> [HKEY_CURRENT_USER\Software\Classes\npprel\shell\open\command]
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> @=<span style=color:#e6db74>&#34;\&#34;</span>%PYTHON_PATH_ESC%\<span style=color:#e6db74>&#34; \&#34;</span>%SCRIPT_PATH_ESC%\<span style=color:#e6db74>&#34; \&#34;</span><span style=color:#ae81ff>%%</span>1\<span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>) &gt; <span style=color:#e6db74>&#34;</span>%TMPREG%<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>reg import <span style=color:#e6db74>&#34;</span>%TMPREG%<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span>.
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> npprel:// protocol installed.
</span></span><span style=display:flex><span><span style=color:#66d9ef>pause</span>
</span></span></code></pre></div><p>where it should be executed to add <code>npprel://</code> url protocol to Windows registry.</p><h2 id=steps>Steps</h2><p>Following are steps to enable <code>npprel://</code> url protocol in a HTML page generated from a Hugo post.</p><ol><li>Create a folder <code>setup/npprel/</code>.</li><li>Inside it add <code>install-npprel.bat</code> and <code>npprel.py</code>.</li><li>Run <code>install-npprel.bat</code> to create a temporary <code>.reg</code> file and import it to register the <code>npprel://</code> protocol.</li><li>Create a shortcode file <code>link/npprel.html</code> in your Hugo project.</li><li>Use that shortcode in a Hugo post to insert a <code>npprel://</code> link.</li><li>Run <code>hugo</code> to build the site.</li><li>Open the generated HTML page from the post.</li><li>Click the <code>npprel://</code> link to launch your handler script.</li></ol><p>Original version and full explanation of the steps is available <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><h2 id=to-do>to-do</h2><ul><li>Perform a pull request in another machine to test whether it also works.</li><li>Add note to previous note about <code>npp://</code> protocol that will be kept only for historical purpose.</li><li>Create a Medium story about this note.</li></ul><h2 id=refs>refs</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Sparisoma Viridi, &ldquo;reg npp protocol&rdquo;, butiran, 21 Sep 2025, url
<a href=/butiran/25i66/><span>https://dudung.github.io/butiran/25i66/
</span></a>[20250921].&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>GPT-5, &ldquo;Fix Hugo path issue for npprel&rdquo;, ChatGPT, 21 Sep 2025, url
<a href=https://chatgpt.com/share/68cfba4b-4730-800a-88ab-44efb3042440 target=_blank rel="nofollow noopener noreferrer"><span>https://chatgpt.com/share/68cfba4b-4730-800a-88ab-44efb3042440 <i class="fa fa-external-link" style=font-size:14px></i>
</span></a>[20250921].&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Avinash Tare, &ldquo;How to create own URL Protocol In Windows&rdquo;, DEV Community, 6 Aug 2024, url
<a href=https://dev.to/avinash_tare/how-to-create-own-url-protocol-in-windows-42bj target=_blank rel="nofollow noopener noreferrer"><span>https://dev.to/avinash_tare/how-to-create-own-url-protocol-in-windows-42bj <i class="fa fa-external-link" style=font-size:14px></i>
</span></a>[20250921].&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>GPT-5, &ldquo;Register custom URL protocol&rdquo;, ChatGPT, 21 Sep 2025, url
<a href=https://chatgpt.com/share/68cfeaf9-03d0-800a-bb07-149118c5ac24 target=_blank rel="nofollow noopener noreferrer"><span>https://chatgpt.com/share/68cfeaf9-03d0-800a-bb07-149118c5ac24 <i class="fa fa-external-link" style=font-size:14px></i>
</span></a>[20250921].&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></div></main><footer><link rel=stylesheet href='/butiran/css/footer.css?v=1761916141'><p>Copyright Sparisoma Viridi 2025<a href=/butiran/h2/ style=cursor:text>.</a>
All rights reserved.
Unless stated otherwise in a note.</p></footer></body></html>